<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#1a1a2e">
    <meta name="description" content="Ho≈üg√∂r√º Bri√ß Kul√ºb√º - Ellerin Kƒ±lavuz G√∂r√ºn√ºm√º">
    <title>Ellerin Kƒ±lavuz G√∂r√ºn√ºm√º</title>
    <style>
        * {
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: #fff;
            margin: 0;
            padding: 20px;
            min-height: 100vh;
        }
        
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
        }
        
        @media (max-width: 480px) {
            body {
                padding: 8px;
            }
        }
        
        .container {
            max-width: 1600px;
            margin: 0 auto;
        }
        
        h1 {
            text-align: center;
            color: #00d9ff;
            margin-bottom: 10px;
            font-size: 1.8em;
        }
        
        @media (max-width: 768px) {
            h1 {
                font-size: 1.4em;
                margin-bottom: 8px;
            }
        }
        
        @media (max-width: 480px) {
            h1 {
                font-size: 1.2em;
                margin-bottom: 5px;
            }
        }
        
        .tournament-info {
            text-align: center;
            color: #aaa;
            margin-bottom: 25px;
            font-size: 0.95em;
        }
        
        @media (max-width: 768px) {
            .tournament-info {
                margin-bottom: 15px;
                font-size: 0.85em;
            }
        }
        
        /* Filter Section */
        .filter-section {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 25px;
            flex-wrap: wrap;
            background: rgba(0, 0, 0, 0.2);
            padding: 15px;
            border-radius: 8px;
        }
        
        @media (max-width: 768px) {
            .filter-section {
                gap: 10px;
                padding: 10px;
                margin-bottom: 15px;
            }
        }
        
        .filter-group {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .filter-group label {
            font-weight: 600;
            color: #00d9ff;
            font-size: 0.95em;
        }
        
        @media (max-width: 768px) {
            .filter-group label {
                font-size: 0.85em;
            }
        }
        
        .filter-group select {
            padding: 8px 12px;
            background: #2a3f5f;
            color: #fff;
            border: 2px solid #00d9ff;
            border-radius: 4px;
            font-size: 0.95em;
            cursor: pointer;
            min-width: 150px;
        }
        
        @media (max-width: 768px) {
            .filter-group select {
                padding: 6px 10px;
                font-size: 0.85em;
                min-width: 120px;
            }
        }
        
        .filter-group select:hover {
            background: #3a4f6f;
        }
        
        .filter-group select:focus {
            outline: none;
            border-color: #00ffff;
        }
        
        .clear-filter {
            padding: 8px 16px;
            background: #ff6b6b;
            color: #fff;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 600;
            font-size: 0.95em;
        }
        
        .clear-filter:hover {
            background: #ff5252;
        }
        
        .loading {
            text-align: center;
            padding: 40px;
            color: #00d9ff;
        }
        
        .error {
            text-align: center;
            padding: 20px;
            color: #ff6b6b;
            background: rgba(255,107,107,0.1);
            border-radius: 8px;
        }
        
        /* GRID LAYOUT */
        /* Desktop: Multiple columns */
        .hands-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(520px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        /* Tablet: 2 columns */
        @media (max-width: 1024px) {
            .hands-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        /* Large Mobile: 2 columns */
        @media (max-width: 900px) {
            .hands-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        /* Mobile: 1 column */
        @media (max-width: 768px) {
            .hands-grid {
                grid-template-columns: 1fr;
                gap: 15px;
                padding: 0 10px;
            }
        }
        
        /* ===== BBO STYLE HAND DIAGRAM ===== */
        .hand-diagram-container {
            display: flex;
            justify-content: center;
            margin-bottom: 25px;
            padding: 0 10px;
        }
        
        @media (max-width: 768px) {
            .hand-diagram-container {
                margin-bottom: 15px;
                padding: 0 5px;
            }
        }
        
        .mainDivStyle {
            position: relative;
            width: 500px;
            height: 475px;
            background: #c0c1c0;
            border-radius: 4px;
            overflow: visible;
        }
        
        /* Responsive sizing for hand diagrams */
        @media (max-width: 900px) {
            .mainDivStyle {
                width: 100%;
                max-width: 500px;
                height: auto;
                aspect-ratio: 500/475;
                font-size: 0.9em;
            }
        }
        
        @media (max-width: 768px) {
            .mainDivStyle {
                width: 100%;
                max-width: 450px;
                aspect-ratio: 500/475;
                font-size: 0.8em;
            }
        }
        
        @media (max-width: 600px) {
            .mainDivStyle {
                width: 100%;
                max-width: 380px;
                aspect-ratio: 500/475;
                font-size: 0.7em;
            }
        }
        
        @media (max-width: 480px) {
            .mainDivStyle {
                width: 100%;
                max-width: 350px;
                aspect-ratio: 500/475;
                font-size: 0.65em;
            }
        }
        
        /* Scale all absolute positioned elements */
        .mainDivStyle .handDivStyle,
        .mainDivStyle .nameRowDivStyle,
        .mainDivStyle .vulInnerDivStyle,
        .mainDivStyle .board-info-left,
        .mainDivStyle .hcp-display {
            transform: scale(var(--scale, 1));
            transform-origin: left top;
        }
        
        .handDivStyle {
            position: absolute;
            background: #cbcbcb;
            width: 160px;
            height: 124px;
            font-size: 22px;
        }
        
        @media (max-width: 768px) {
            .handDivStyle {
                width: 160px;
                height: 124px;
                font-size: 18px;
            }
        }
        
        @media (max-width: 600px) {
            .handDivStyle {
                width: 140px;
                height: 110px;
                font-size: 16px;
            }
        }
        
        @media (max-width: 480px) {
            .handDivStyle {
                width: 120px;
                height: 95px;
                font-size: 14px;
            }
        }
        
        .suitRowDivStyle {
            position: relative;
            height: 25px;
            line-height: 25px;
            white-space: nowrap;
            padding-left: 5px;
        }
        
        @media (max-width: 768px) {
            .suitRowDivStyle {
                height: 22px;
                line-height: 22px;
                padding-left: 4px;
            }
        }
        
        @media (max-width: 600px) {
            .suitRowDivStyle {
                height: 20px;
                line-height: 20px;
                padding-left: 3px;
            }
        }
        
        .suitSymbol {
            display: inline-block;
            width: 30px;
            font-size: 30px;
            text-align: center;
            vertical-align: middle;
        }
        
        @media (max-width: 768px) {
            .suitSymbol {
                width: 26px;
                font-size: 26px;
            }
        }
        
        @media (max-width: 600px) {
            .suitSymbol {
                width: 22px;
                font-size: 22px;
            }
        }
        
        @media (max-width: 480px) {
            .suitSymbol {
                width: 18px;
                font-size: 18px;
            }
        }
        
        .suitHolding {
            display: inline-block;
            font-size: 22px;
            letter-spacing: 2px;
            vertical-align: middle;
            color: #000;
        }
        
        @media (max-width: 768px) {
            .suitHolding {
                font-size: 18px;
                letter-spacing: 1px;
            }
        }
        
        @media (max-width: 600px) {
            .suitHolding {
                font-size: 16px;
                letter-spacing: 0.5px;
            }
        }
        
        @media (max-width: 480px) {
            .suitHolding {
                font-size: 13px;
                letter-spacing: 0.3px;
            }
        }
        
        .nameRowDivStyle {
            position: absolute;
            height: 30px;
            line-height: 30px;
            border: 1px solid white;
            white-space: nowrap;
            font-size: 18px;
            font-weight: bold;
            background: white;
        }
        
        @media (max-width: 768px) {
            .nameRowDivStyle {
                height: 26px;
                line-height: 26px;
                font-size: 16px;
            }
        }
        
        @media (max-width: 600px) {
            .nameRowDivStyle {
                height: 23px;
                line-height: 23px;
                font-size: 14px;
            }
        }
        
        @media (max-width: 480px) {
            .nameRowDivStyle {
                height: 20px;
                line-height: 20px;
                font-size: 12px;
            }
        }
        
        .nameInitial {
            display: inline-block;
            width: 30px;
            text-align: center;
            font-weight: bold;
            color: #000;
            font-size: 16px;
        }
        
        @media (max-width: 768px) {
            .nameInitial {
                width: 26px;
                font-size: 14px;
            }
        }
        
        @media (max-width: 600px) {
            .nameInitial {
                width: 23px;
                font-size: 12px;
            }
        }
        
        @media (max-width: 480px) {
            .nameInitial {
                width: 20px;
                font-size: 10px;
            }
        }
        
        .vulInnerDivStyle {
            position: absolute;
            background: white;
            border: 3px solid #880000;
            font-size: 42px;
            font-weight: bold;
            text-align: center;
            width: 60px;
            height: 60px;
            line-height: 54px;
        }
        
        @media (max-width: 768px) {
            .vulInnerDivStyle {
                font-size: 36px;
                width: 52px;
                height: 52px;
                line-height: 47px;
                border: 2px solid #880000;
            }
        }
        
        @media (max-width: 600px) {
            .vulInnerDivStyle {
                font-size: 30px;
                width: 46px;
                height: 46px;
                line-height: 42px;
                border: 2px solid #880000;
            }
        }
        
        @media (max-width: 480px) {
            .vulInnerDivStyle {
                font-size: 24px;
                width: 40px;
                height: 40px;
                line-height: 36px;
                border: 1.5px solid #880000;
            }
        }
        
        .dealer-bg { background: #ffce00 !important; color: black !important; }
        .vul-bg { background: #cb0000 !important; color: white !important; }
        
        /* Position Classes */
        .pos-n-name { left: 170px; top: 5px; width: 160px; }
        .pos-n-hand { left: 170px; top: 35px; }
        .pos-w-name { left: 5px; top: 160px; width: 160px; }
        .pos-w-hand { left: 5px; top: 190px; }
        .pos-e-name { left: 335px; top: 160px; width: 160px; }
        .pos-e-hand { left: 335px; top: 190px; }
        .pos-s-name { left: 170px; top: 315px; width: 160px; }
        .pos-s-hand { left: 170px; top: 345px; }
        
        @media (max-width: 768px) {
            .pos-n-name { left: 15%; top: 1%; width: 70%; }
            .pos-n-hand { left: 15%; top: 8%; }
            .pos-w-name { left: 1%; top: 33%; width: 32%; }
            .pos-w-hand { left: 1%; top: 40%; }
            .pos-e-name { left: 67%; top: 33%; width: 32%; }
            .pos-e-hand { left: 67%; top: 40%; }
            .pos-s-name { left: 15%; top: 66%; width: 70%; }
            .pos-s-hand { left: 15%; top: 73%; }
        }
        
        @media (max-width: 600px) {
            .pos-n-name { left: 15%; top: 2%; width: 70%; }
            .pos-n-hand { left: 15%; top: 9%; }
            .pos-w-name { left: 2%; top: 34%; width: 31%; }
            .pos-w-hand { left: 2%; top: 41%; }
            .pos-e-name { left: 67%; top: 34%; width: 31%; }
            .pos-e-hand { left: 67%; top: 41%; }
            .pos-s-name { left: 15%; top: 65%; width: 70%; }
            .pos-s-hand { left: 15%; top: 72%; }
        }
        
        .pos-board { 
            left: 220px; 
            top: 215px;
            width: 60px;
            height: 60px;
            background: #ffce00 !important;
            border: 3px solid #333 !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
            font-size: 28px !important;
            font-weight: bold !important;
            color: #000 !important;
            z-index: 100;
            line-height: 60px;
        }
        
        @media (max-width: 768px) {
            .pos-board {
                left: 42%;
                top: 45%;
                width: 52px;
                height: 52px;
                font-size: 24px !important;
                line-height: 52px;
                border: 2px solid #333 !important;
            }
        }
        
        @media (max-width: 600px) {
            .pos-board {
                left: 42%;
                top: 46%;
                width: 46px;
                height: 46px;
                font-size: 20px !important;
                line-height: 46px;
                border: 2px solid #333 !important;
            }
        }
        
        @media (max-width: 480px) {
            .pos-board {
                left: 42%;
                top: 47%;
                width: 40px;
                height: 40px;
                font-size: 16px !important;
                line-height: 40px;
                border: 1.5px solid #333 !important;
            }
        }
        
        /* Board Info - Left Side */
        .board-info-left {
            position: absolute;
            left: 8px;
            top: 8px;
            font-size: 15px;
            color: #333;
            line-height: 1.6;
            text-align: left;
        }
        
        @media (max-width: 768px) {
            .board-info-left {
                font-size: 13px;
                left: 6px;
                top: 6px;
                line-height: 1.4;
            }
        }
        
        @media (max-width: 600px) {
            .board-info-left {
                font-size: 11px;
                left: 5px;
                top: 5px;
                line-height: 1.3;
            }
        }
        
        @media (max-width: 480px) {
            .board-info-left {
                font-size: 9px;
                left: 4px;
                top: 4px;
                line-height: 1.2;
            }
        }
        
        .board-info-left .date {
            font-weight: bold;
        }
        
        .board-info-left .dealer {
            background: #ffce00;
            color: black;
            font-weight: bold;
            padding: 1px 4px;
            border-radius: 2px;
            display: block;
        }
        
        .board-info-left .vul {
            font-weight: bold;
            padding: 2px 6px;
            border-radius: 2px;
            display: block;
            margin-top: 2px;
            text-align: center;
        }
        
        .board-info-left .vul.vul-active {
            background: #cb0000;
            color: white;
        }
        
        /* HCP Display */
        .hcp-display {
            position: absolute;
            left: 335px;
            top: 35px;
            width: 160px;
            font-size: 16px;
            color: #333;
            text-align: center;
        }
        
        @media (max-width: 768px) {
            .hcp-display {
                left: 67%;
                top: 8%;
                width: 32%;
                font-size: 14px;
            }
        }
        
        @media (max-width: 600px) {
            .hcp-display {
                left: 67%;
                top: 9%;
                width: 31%;
                font-size: 12px;
            }
        }
        
        @media (max-width: 480px) {
            .hcp-display {
                left: 65%;
                top: 10%;
                width: 33%;
                font-size: 10px;
            }
        }
        
        .hcp-display .hcp-north {
            text-align: center;
            font-weight: bold;
        }
        
        .hcp-display .hcp-south {
            text-align: center;
            font-weight: bold;
            margin-top: 10px;
        }
        
        @media (max-width: 600px) {
            .hcp-display .hcp-south {
                margin-top: 5px;
            }
        }
        
        .hcp-display .hcp-middle {
            display: flex;
            justify-content: space-between;
            padding: 8px 20px;
            margin-top: 5px;
        }
        
        @media (max-width: 600px) {
            .hcp-display .hcp-middle {
                padding: 5px 10px;
                margin-top: 3px;
            }
        }
        
        .hcp-display .hcp-value {
            font-weight: bold;
            color: #000;
            font-size: 18px;
        }
        
        @media (max-width: 768px) {
            .hcp-display .hcp-value {
                font-size: 16px;
            }
        }
        
        @media (max-width: 600px) {
            .hcp-display .hcp-value {
                font-size: 14px;
            }
        }
        
        @media (max-width: 480px) {
            .hcp-display .hcp-value {
                font-size: 12px;
            }
        }
        
        /* DD Table - BBO Style */
        .bhDoubleDummy {
            position: relative;
            padding: 5px 3px;
            border: none;
            background: transparent;
            font-size: 10px;
            width: auto;
            min-width: 150px;
            color: #000;
            margin-top: 10px;
            margin-bottom: 5px;
        }
        
        @media (max-width: 768px) {
            .bhDoubleDummy {
                font-size: 9px;
                padding: 3px 2px;
                margin-top: 8px;
            }
        }
        
        .bh-dd {
            text-align: center;
            border-collapse: collapse;
            margin-bottom: 5px;
            color: #000;
        }
        
        .bh-dd th, .bh-dd td {
            width: 26px;
            height: 21px;
            text-align: center;
            color: #000;
        }
        
        @media (max-width: 768px) {
            .bh-dd th, .bh-dd td {
                width: 22px;
                height: 18px;
                padding: 1px;
            }
        }
        
        .bh-dd th {
            font-weight: bold;
            border: none;
            color: #000;
        }
        
        .bh-dd th:first-child {
            width: 20px;
        }
        
        .bh-dd td {
            border: none;
            background: #fff;
            color: #000;
        }
        
        .bh-dd td:first-child {
            border: none;
            font-weight: bold;
            background: transparent;
        }
        
        .bh-dd .suit-symbol {
            font-size: 16px;
        }
        
        .par-display {
            font-size: 12px;
            line-height: 1.4;
            color: #000;
        }
        
        .par-display strong {
            display: block;
        }
        
        /* Suit colors */
        .suit-black { color: #000 !important; }
        .suit-red { color: #cb0000 !important; }
        
        /* LoTT Display */
        .lottDisplay {
            position: relative;
            padding: 8px;
            border: 1px solid #999;
            background: #e8e8e8;
            color: #000;
            font-size: 13px;
            text-align: center;
            min-width: 80px;
            margin-top: 8px;
            margin-left: auto;
            margin-right: auto;
            width: fit-content;
        }
        
        @media (max-width: 768px) {
            .lottDisplay {
                padding: 6px;
                font-size: 11px;
                min-width: 70px;
                margin-top: 6px;
            }
        }
        
        .lott-title {
            font-weight: bold;
            color: black;
            margin-bottom: 3px;
            font-size: 1.125em;
        }
        
        .lott-value {
            font-size: 35px;
            font-weight: bold;
            color: black;
        }
        
        .lott-detail {
            font-size: 12.5px;
            color: black;
            margin-top: 3px;
        }
        /* ===== END BBO STYLE ===== */
        
        /* Mobile wrapper for scaling */
        .scale-wrapper {
            display: inline-block;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üé¥ Ellerin Kƒ±lavuz G√∂r√ºn√ºm√º</h1>
        <div class="tournament-info">
            <span id="tournament-name">Y√ºkleniyor...</span> ‚Ä¢ 
            <span id="board-count">0</span> El
        </div>
        
        <!-- Filter Section -->
        <div class="filter-section" id="filter-section" style="display: none;">
            <div class="filter-group">
                <label for="date-filter">Tarih Filtresi:</label>
                <select id="date-filter" onchange="filterByDate()">
                    <option value="">-- T√ºm Tarihleri G√∂ster --</option>
                </select>
            </div>
            <button class="clear-filter" onclick="clearFilters()">Filtreyi Temizle</button>
        </div>
        
        <div id="loading" class="loading">Elleri y√ºkleniyor...</div>
        <div id="error" class="error" style="display:none;"></div>
        <div class="hands-grid" id="hands-grid"></div>
    </div>

    <script src="card_placement.js"></script>
    <script src="lin_generator.js"></script>
    <script>
        // Main page logic - card placement and diagram rendering functions are in card_placement.js
        // LIN generation functions are in lin_generator.js
        
        // Global variables for filtering
        let allHands = [];
        let allDates = [];

        function formatSuitWithColor(text) {
            if (!text) return '';
            return text
                .replace(/‚ô†/g, '<span class="suit-black">‚ô†</span>')
                .replace(/‚ô£/g, '<span class="suit-black">‚ô£</span>')
                .replace(/‚ô•/g, '<span class="suit-red">‚ô•</span>')
                .replace(/‚ô¶/g, '<span class="suit-red">‚ô¶</span>');
        }

        // DD table rendering is in card_placement.js: renderDDTable()

        // Hand diagram rendering is now in card_placement.js
        // Call: renderHandDiagram(handObj, boardNum, ddResult, optimum, lott)

        // Render hands to grid
        async function renderHands(handsToRender) {
            const grid = document.getElementById('hands-grid');
            grid.innerHTML = '';
            
            console.log(`%cRENDERING ${handsToRender.length} HANDS`, 'color:blue;font-size:16px;font-weight:bold');
            if (handsToRender.length === 0) {
                console.warn('No hands to render!');
                return;
            }

            // Batch fetch all DD data in parallel
            console.log('Fetching DD data for all hands in parallel...');
            const ddDataMap = {};
            const ddFetchPromises = handsToRender.map(hand => 
                fetch(`/api/hand-data?event=${hand.event_id}&board=${hand.board}`)
                    .then(res => res.ok ? res.json() : null)
                    .then(data => {
                        const key = `${hand.event_id}_${hand.board}`;
                        if (data) {
                            ddDataMap[key] = {
                                dd_result: data.dd_result,
                                optimum: data.optimum,
                                lott: data.lott
                            };
                        }
                    })
                    .catch(e => console.warn(`Failed to fetch DD data for event ${hand.event_id} board ${hand.board}:`, e))
            );
            
            await Promise.all(ddFetchPromises);
            console.log('DD data fetched. Rendering hands...');

            let handCount = 0;
            for (const hand of handsToRender) {
                handCount++;
                console.log(`Hand ${handCount}/${handsToRender.length}: Event ${hand.event_id}, Board ${hand.board}`);
                const handObj = {
                    N: hand.N,
                    E: hand.E,
                    S: hand.S,
                    W: hand.W,
                    dealer: hand.dealer || 'N',
                    vulnerability: hand.vulnerability || 'None',
                    date: hand.date || 'Unknown',
                    event_id: hand.event_id || '?'
                };

                // Get DD data from map (already fetched)
                const key = `${hand.event_id}_${hand.board}`;
                const ddData = ddDataMap[key] || {};
                const ddResult = ddData.dd_result || null;
                const optimum = ddData.optimum || null;
                const lott = ddData.lott || null;

                // Create custom HTML with event info
                const baseHtml = renderHandDiagram(handObj, hand.board, ddResult, optimum, lott);
                const div = document.createElement('div');
                div.innerHTML = baseHtml;
                
                // Add event label above the hand diagram (HIDDEN)
                const eventLabel = document.createElement('div');
                eventLabel.style.cssText = 'text-align:center; font-weight:bold; color:#666; margin-bottom:5px; font-size:12px; display: none;';
                eventLabel.textContent = `Event ${hand.event_id} | ${hand.date}`;
                
                const container = document.createElement('div');
                container.appendChild(eventLabel);
                container.appendChild(div.firstElementChild);
                grid.appendChild(container);
                
                console.log(`Added hand: Event ${hand.event_id}, Board ${hand.board}`);
            }
            
            console.log(`%cTOTAL HANDS ADDED TO GRID: ${grid.children.length}`, 'color:green;font-size:14px;font-weight:bold');
            const dateCount = new Set(handsToRender.map(h => h.date)).size;
            
            const summaryText = `Events (${handsToRender.length} hands from ${dateCount} date(s))`;
            document.getElementById('tournament-name').textContent = summaryText;
            document.getElementById('board-count').textContent = handsToRender.length;
            
            // Also log to a visible element for debugging
            console.log(`Summary updated: "${summaryText}"`);
        }

        // Filter by selected date
        function filterByDate() {
            const selectedDate = document.getElementById('date-filter').value;
            
            if (!selectedDate) {
                console.log(`Showing all ${allHands.length} hands`);
                renderHands(allHands);
                return;
            }
            
            const filtered = allHands.filter(hand => hand.date === selectedDate);
            console.log(`Filtered to ${filtered.length} hands for date ${selectedDate}`);
            renderHands(filtered);
        }

        // Clear all filters
        function clearFilters() {
            document.getElementById('date-filter').value = '';
            renderHands(allHands);
        }

        // Load hands from database
        async function loadHands() {
            try {
                const response = await fetch('/hands_database.json');
                if (!response.ok) throw new Error('Failed to load hands database');
                
                const database = await response.json();
                document.getElementById('loading').style.display = 'none';
                document.getElementById('filter-section').style.display = 'flex';

                allHands = database;

                if (allHands.length === 0) throw new Error('No hands found in database');

                // Sort by event_id, then board number
                allHands.sort((a, b) => {
                    if (a.event_id !== b.event_id) return a.event_id - b.event_id;
                    return a.board - b.board;
                });

                // Get unique dates sorted
                allDates = [...new Set(allHands.map(h => h.date))].sort();
                console.log(`Loaded ${allHands.length} hands from database`);
                console.log(`Dates: ${allDates.join(', ')}`);

                // Populate date filter dropdown
                const dateFilter = document.getElementById('date-filter');
                allDates.forEach(date => {
                    const option = document.createElement('option');
                    option.value = date;
                    option.textContent = date;
                    dateFilter.appendChild(option);
                });

                // Check if URL has a date parameter for auto-filtering
                const params = new URLSearchParams(window.location.search);
                const urlDate = params.get('date');
                console.log(`URL date parameter: ${urlDate}, Available dates: ${allDates.join(', ')}`);
                if (urlDate && allDates.includes(urlDate)) {
                    console.log(`Auto-filtering to date: ${urlDate}`);
                    document.getElementById('date-filter').value = urlDate;
                    filterByDate();
                } else {
                    console.log(`No date filter applied, showing all ${allHands.length} hands`);
                    renderHands(allHands);
                }

            } catch (error) {
                console.error('Error loading hands:', error);
                document.getElementById('loading').style.display = 'none';
                document.getElementById('error').textContent = `Hata: ${error.message}`;
                document.getElementById('error').style.display = 'block';
            }
        }

        // Load on page load
        window.addEventListener('load', loadHands);
    </script>
</body>
</html>
