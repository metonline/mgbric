<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bridge Tournament Analyzer</title>
    <style>
        * { box-sizing: border-box; }
        body {
            font-family: Arial, sans-serif;
            background: #f5f5f5;
            padding: 20px;
            margin: 0;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        h1 {
            text-align: center;
            color: #333;
            margin: 0 0 30px 0;
        }
        .nav-bar {
            margin-bottom: 20px;
        }
        .nav-btn {
            padding: 8px 16px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin-right: 10px;
            font-weight: bold;
        }
        .nav-btn:hover {
            background: #5568d3;
        }
        .nav-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
        }
        .page {
            display: none;
        }
        .page.active {
            display: block;
        }
        .tournaments-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }
        .tournament-card {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            cursor: pointer;
            transition: all 0.2s;
        }
        .tournament-card:hover {
            box-shadow: 0 4px 16px rgba(0,0,0,0.15);
            transform: translateY(-2px);
        }
        .tournament-card h3 {
            margin: 0 0 10px 0;
            color: #333;
        }
        .tournament-card p {
            margin: 5px 0;
            color: #666;
            font-size: 13px;
        }
        .boards-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 10px;
        }
        .board-item {
            background: white;
            padding: 15px;
            border-radius: 4px;
            text-align: center;
            cursor: pointer;
            border: 2px solid #ddd;
            transition: all 0.2s;
        }
        .board-item:hover {
            border-color: #667eea;
            background: #f0f0ff;
        }
        .board-num {
            font-weight: bold;
            font-size: 18px;
            color: #333;
        }
        .board-info {
            font-size: 11px;
            color: #999;
            margin-top: 5px;
        }
        .board-detail {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .board-header {
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 2px solid #667eea;
            padding-bottom: 15px;
        }
        .board-header h2 {
            margin: 0 0 10px 0;
            color: #333;
        }
        .board-header p {
            margin: 5px 0;
            color: #666;
            font-size: 14px;
        }
        .hand-diagram {
            display: flex;
            justify-content: center;
            gap: 40px;
            margin-bottom: 40px;
            align-items: center;
        }
        .hand-card {
            text-align: center;
            padding: 15px;
            background: white;
            border-radius: 4px;
            border: 1px solid #ddd;
            min-width: 100px;
        }
        .hand-card-title {
            font-weight: bold;
            font-size: 13px;
            margin-bottom: 8px;
            color: #333;
        }
        .suit {
            font-size: 12px;
            line-height: 1.6;
            margin: 3px 0;
        }
        .results-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        .results-table th,
        .results-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
            font-size: 13px;
        }
        .results-table th {
            background: #f5f5f5;
            font-weight: bold;
            color: #333;
        }
        .results-table tr:hover {
            background: #f9f9f9;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üé¥ Bridge Tournament Analyzer</h1>
        
        <div class="nav-bar">
            <button class="nav-btn" id="backBtn" onclick="goBack()" style="display:none;">‚Üê Back</button>
        </div>

        <!-- Tournaments Page -->
        <div id="tournamentsPage" class="page active">
            <div class="tournaments-grid" id="tournamentsGrid"></div>
        </div>

        <!-- Boards Page -->
        <div id="boardsPage" class="page">
            <h2 id="tournamentTitle" style="margin-bottom: 20px;"></h2>
            <div class="boards-list" id="boardsList"></div>
        </div>

        <!-- Board Details Page -->
        <div id="boardDetailsPage" class="page">
            <div class="board-detail">
                <div class="board-header" id="boardHeader"></div>
                <div class="hand-diagram" id="handDiagram"></div>
                <div style="margin-top: 40px;">
                    <h3>Results Summary</h3>
                    <table class="results-table">
                        <thead>
                            <tr>
                                <th>Table</th>
                                <th>Pair</th>
                                <th>Contract</th>
                                <th>Decl</th>
                                <th>Lead</th>
                                <th>Result</th>
                                <th>Score</th>
                            </tr>
                        </thead>
                        <tbody id="resultsBody"></tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <script>
        let allData = {};
        let currentState = { page: 'tournaments', tournament: null, board: null };

        window.addEventListener('load', () => {
            fetch('hands_database.json')
                .then(r => r.json())
                .then(data => {
                    allData = data;
                    displayTournaments();
                })
                .catch(e => console.error('Error loading database:', e));
        });

        function displayTournaments() {
            const grid = document.getElementById('tournamentsGrid');
            grid.innerHTML = '';
            
            Object.entries(allData.events || {}).forEach(([key, event]) => {
                const boardCount = Object.keys(event.boards || {}).length;
                grid.innerHTML += `
                    <div class="tournament-card" onclick="selectTournament('${key}')">
                        <h3>${event.name}</h3>
                        <p><strong>Date:</strong> ${event.date || 'N/A'}</p>
                        <p><strong>Location:</strong> ${event.location || 'N/A'}</p>
                        <p><strong>Boards:</strong> ${boardCount}</p>
                    </div>
                `;
            });
        }

        function selectTournament(eventKey) {
            currentState = { page: 'boards', tournament: eventKey, board: null };
            const event = allData.events[eventKey];
            
            document.getElementById('tournamentsPage').classList.remove('active');
            document.getElementById('boardsPage').classList.add('active');
            document.getElementById('backBtn').style.display = 'inline-block';
            
            document.getElementById('tournamentTitle').textContent = event.name;
            
            const boardsList = document.getElementById('boardsList');
            boardsList.innerHTML = '';
            
            Object.entries(event.boards || {}).forEach(([boardNum, board]) => {
                boardsList.innerHTML += `
                    <div class="board-item" onclick="selectBoard('${eventKey}', '${boardNum}')">
                        <div class="board-num">Board ${boardNum}</div>
                        <div class="board-info">Dealer: ${board.dealer || 'N'}</div>
                    </div>
                `;
            });
        }

        function selectBoard(eventKey, boardNum) {
            currentState = { page: 'details', tournament: eventKey, board: boardNum };
            const event = allData.events[eventKey];
            const board = event.boards[boardNum];
            
            document.getElementById('boardsPage').classList.remove('active');
            document.getElementById('boardDetailsPage').classList.add('active');
            
            // Display header
            document.getElementById('boardHeader').innerHTML = `
                <h2>${event.name}</h2>
                <p>Board ${boardNum} ‚Ä¢ Dealer: ${board.dealer || 'N'} ‚Ä¢ Vulnerability: ${board.vulnerability || 'None'}</p>
            `;
            
            // Display hand diagram
            displayHandDiagram(board.hands);
            
            // Display results
            displayResults(board.results || []);
        }

        function displayHandDiagram(hands) {
            const suits = ['S', 'H', 'D', 'C'];
            const suitSymbols = { 'S': '‚ô†', 'H': '‚ô•', 'D': '‚ô¶', 'C': '‚ô£' };
            const suitColors = { 'S': '#000', 'H': '#e41e3f', 'D': '#e41e3f', 'C': '#000' };
            
            let html = '';
            
            // West
            html += '<div class="hand-card">' + renderHand('West', hands.West, suits, suitSymbols, suitColors) + '</div>';
            
            // Center: North and South
            html += '<div style="display: flex; flex-direction: column; gap: 20px; align-items: center;">';
            html += '<div class="hand-card">' + renderHand('North', hands.North, suits, suitSymbols, suitColors) + '</div>';
            html += '<div style="color: #999; font-size: 12px;">‚ô† ‚ô• ‚ô¶ ‚ô£</div>';
            html += '<div class="hand-card">' + renderHand('South', hands.South, suits, suitSymbols, suitColors) + '</div>';
            html += '</div>';
            
            // East
            html += '<div class="hand-card">' + renderHand('East', hands.East, suits, suitSymbols, suitColors) + '</div>';
            
            document.getElementById('handDiagram').innerHTML = html;
        }

        function renderHand(pos, hand, suits, symbols, colors) {
            let html = '<div class="hand-card-title">' + pos + '</div>';
            suits.forEach(suit => {
                const cards = hand[suit] || '-';
                html += '<div class="suit" style="color: ' + colors[suit] + ';"><strong>' + symbols[suit] + '</strong> ' + cards + '</div>';
            });
            return html;
        }

        function displayResults(results) {
            const tbody = document.getElementById('resultsBody');
            tbody.innerHTML = '';
            
            if (!results || results.length === 0) {
                tbody.innerHTML = '<tr><td colspan="7" style="text-align: center; color: #999;">No results available</td></tr>';
                return;
            }
            
            results.forEach(result => {
                tbody.innerHTML += `
                    <tr>
                        <td>${result.table || '-'}</td>
                        <td>${result.pair || '-'}</td>
                        <td><strong>${result.contract || '-'}</strong></td>
                        <td>${result.declarer || '-'}</td>
                        <td>${result.lead || '-'}</td>
                        <td>${result.result || '-'}</td>
                        <td>${result.score || '-'}</td>
                    </tr>
                `;
            });
        }

        function goBack() {
            if (currentState.page === 'details') {
                currentState.page = 'boards';
                document.getElementById('boardDetailsPage').classList.remove('active');
                document.getElementById('boardsPage').classList.add('active');
            } else if (currentState.page === 'boards') {
                currentState.page = 'tournaments';
                document.getElementById('boardsPage').classList.remove('active');
                document.getElementById('tournamentsPage').classList.add('active');
                document.getElementById('backBtn').style.display = 'none';
            }
        }
    </script>
</body>
</html>
