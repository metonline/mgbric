<!DOCTYPE html>
<html>
<head>
    <title>Test LIN Format</title>
    <style>
        body { font-family: monospace; padding: 20px; background: #f5f5f5; }
        .container { background: white; padding: 20px; border-radius: 8px; max-width: 900px; }
        pre { background: #f0f0f0; padding: 15px; border-radius: 4px; overflow-x: auto; }
        .hands { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 20px 0; }
        .hand { background: #f9f9f9; padding: 15px; border: 1px solid #ddd; border-radius: 4px; }
        .hand h3 { margin-top: 0; color: #333; }
    </style>
</head>
<body>
    <div class="container">
        <h1>LIN Format Test</h1>
        <p>Board 1 Data (from database):</p>
        
        <div class="hands" id="handsDisplay"></div>
        
        <h2>Generated LIN Strings:</h2>
        <pre id="linOutput"></pre>
        
        <h2>Expected Format:</h2>
        <p>md|[dealer][N hand],[S hand],[E hand],[W hand]|sv|[vuln]</p>
    </div>

    <script>
        async function testLIN() {
            try {
                // Load database
                const response = await fetch('hands_database.json?v=' + Date.now());
                const db = await response.json();
                const board = db.events['hosgoru_04_01_2026'].boards['1'];
                const hands = board.hands;
                
                // Display hands
                let html = '';
                const positions = ['North', 'South', 'East', 'West'];
                positions.forEach(pos => {
                    const hand = hands[pos];
                    html += `<div class="hand">
                        <h3>${pos}</h3>
                        <div>S: ${hand.S}</div>
                        <div>H: ${hand.H}</div>
                        <div>D: ${hand.D}</div>
                        <div>C: ${hand.C}</div>
                    </div>`;
                });
                document.getElementById('handsDisplay').innerHTML = html;
                
                // Test different LIN formats
                const formatHand = (playerHand) => {
                    if (!playerHand) return 'SDHC';
                    const suits = ['S', 'H', 'D', 'C'];
                    return suits.map(s => s + (playerHand[s] || '-')).join('');
                };
                
                const nHand = formatHand(hands.North);
                const sHand = formatHand(hands.South);
                const eHand = formatHand(hands.East);
                const wHand = formatHand(hands.West);
                
                let output = 'Formatted Hands:\n';
                output += `North: ${nHand}\n`;
                output += `South: ${sHand}\n`;
                output += `East:  ${eHand}\n`;
                output += `West:  ${wHand}\n\n`;
                
                // Current implementation
                output += '=== CURRENT (Simple) ===\n';
                const dealer = board.dealer.toLowerCase();
                const lin1 = `md|${dealer}${nHand},${sHand},${eHand},${wHand}|sv|n`;
                output += `${lin1}\n\n`;
                
                // Try rotating by dealer
                output += '=== OPTION 1: Rotate by dealer ===\n';
                let lin2;
                if (board.dealer === 'N') {
                    lin2 = `md|n${nHand},${eHand},${sHand},${wHand}|sv|n`;
                    output += '(N dealer, order: N,E,S,W)\n';
                } else if (board.dealer === 'E') {
                    lin2 = `md|e${eHand},${sHand},${wHand},${nHand}|sv|n`;
                    output += '(E dealer, order: E,S,W,N)\n';
                } else if (board.dealer === 'S') {
                    lin2 = `md|s${sHand},${wHand},${nHand},${eHand}|sv|n`;
                    output += '(S dealer, order: S,W,N,E)\n';
                } else {
                    lin2 = `md|w${wHand},${nHand},${eHand},${sHand}|sv|n`;
                    output += '(W dealer, order: W,N,E,S)\n';
                }
                output += `${lin2}\n\n`;
                
                // Try with reversed E/W
                output += '=== OPTION 2: Simple N,S,E,W (different order) ===\n';
                const lin3 = `md|n${nHand},${sHand},${wHand},${eHand}|sv|n`;
                output += `${lin3}\n\n`;
                
                document.getElementById('linOutput').textContent = output;
                
            } catch (error) {
                document.getElementById('linOutput').textContent = 'Error: ' + error.message;
            }
        }
        
        testLIN();
    </script>
</body>
</html>
