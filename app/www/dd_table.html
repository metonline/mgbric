<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DD Analysis Table</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: transparent;
            padding: 10px;
            overflow: hidden;
        }

        .dd-analysis {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .dd-title {
            font-size: 14px;
            font-weight: 700;
            color: #333;
            text-align: center;
        }

        .dd-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 13px;
            background: white;
        }

        .dd-table th,
        .dd-table td {
            padding: 6px 8px;
            text-align: center;
            border: 1px solid #ddd;
        }

        .dd-table th {
            background: #f0f0f0;
            font-weight: 700;
            color: #333;
        }

        .dd-table td {
            background: white;
            font-weight: 600;
            color: #333;
        }

        .dd-table tbody tr:nth-child(even) {
            background: #fafafa;
        }

        .dd-table .suit-red {
            color: #c41e3a;
            font-weight: 700;
        }

        .dd-table .suit-black {
            color: #000;
            font-weight: 700;
        }

        .dd-denom {
            font-weight: 700;
            background: #f5f5f5;
            color: #333;
        }
    </style>
</head>
<body>
    <div class="dd-analysis" id="ddContainer"></div>

    <script>
        // Parse DD data from URL parameter or query string
        function getDDFromURL() {
            const params = new URLSearchParams(window.location.search);
            const ddParam = params.get('dd');
            if (ddParam) {
                try {
                    return JSON.parse(decodeURIComponent(ddParam));
                } catch (e) {
                    console.error('Failed to parse DD data:', e);
                }
            }
            return null;
        }

        function createDDTable(ddData) {
            if (!ddData) {
                return '<div class="dd-title">No DD Data Available</div>';
            }

            const denominations = ['NT', 'S', 'H', 'D', 'C'];
            const seats = ['N', 'S', 'E', 'W'];

            let tableHTML = '<div class="dd-title">Double Dummy Tricks</div>';
            tableHTML += '<table class="dd-table"><thead><tr><th></th>';
            
            // Add denomination headers with color coding
            denominations.forEach(denom => {
                if (denom === 'NT') {
                    tableHTML += `<th>NT</th>`;
                } else if (denom === 'S' || denom === 'C') {
                    tableHTML += `<th><span class="suit-black">${denom === 'S' ? '♠' : '♣'}</span></th>`;
                } else {
                    tableHTML += `<th><span class="suit-red">${denom === 'H' ? '♥' : '♦'}</span></th>`;
                }
            });
            tableHTML += '</tr></thead><tbody>';

            // Add each seat row (N, S, E, W)
            seats.forEach(seat => {
                tableHTML += `<tr><td class="dd-denom">${seat}</td>`;
                denominations.forEach(denom => {
                    const key = `${denom}${seat}`;
                    const tricks = ddData[key];
                    // Display tricks (6-13) where 6 = pass, 7-13 = tricks made
                    let display = '-';
                    if (typeof tricks === 'number' && tricks >= 6 && tricks <= 13) {
                        display = tricks.toString();
                    }
                    tableHTML += `<td>${display}</td>`;
                });
                tableHTML += '</tr>';
            });

            tableHTML += '</tbody></table>';
            return tableHTML;
        }

        // Get DD data and render
        const ddData = getDDFromURL();
        const container = document.getElementById('ddContainer');
        container.innerHTML = createDDTable(ddData);
    </script>
</body>
</html>
